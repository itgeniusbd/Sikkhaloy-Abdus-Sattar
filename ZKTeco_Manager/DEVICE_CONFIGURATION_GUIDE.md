# ZKTeco Device Configuration Guide
## ?????? ????? ????

### Server URL: `https://pushapi.sikkhaloy.com`

---

## ?? ???? ???: Device Date/Time Format ??? ????

### ?? IMPORTANT: ???????? Date/Time Format ?????? ??????

??? ????? ??????? ???? ??? format ? ?????? (????: "12:13:38 11:10 AM"), ????? ????? steps follow ????:

#### Method 1: Device LCD Menu ???? (Recommended)

1. **Menu** ? **System** ? **Date/Time**
2. ????? settings ????:
   ```
   Date Format: DD-MM-YY (???? DD-MM-YYYY)
   Time Format: 24H (24 hour format - AM/PM ???)
   Time Zone: GMT+6 (Bangladesh)
   ```
3. **Save** ???? ??? **Device Restart** ????

#### Method 2: NTP Server ????? Auto Time Sync (Best Practice)

1. **Menu** ? **Comm** ? **NTP Server**
2. Settings:
   ```
   Enable NTP: Yes
   NTP Server: time.google.com (???? pool.ntp.org)
   Time Zone: +6
   Auto Sync: Yes
   Sync Interval: 24 hours
   ```
3. **Save** ???? ??? **Test** ????

#### Method 3: Web Interface ????

1. Browser ? device ?? IP ??? (????: `http://192.168.1.100`)
2. **Login** ???? (default: admin/admin)
3. **System** ? **Date/Time Settings**
4. ???? format select ????:
   ```
   Date Format: DD-MM-YY
   Time Format: 24H
   Time Zone: GMT+6
   ```

#### Method 4: API ???? Check ????

????? device ?? configuration check ????:
```
https://pushapi.sikkhaloy.com/iclock/configure-datetime?SN=YOUR_DEVICE_SN
```

??? ?????? ????????? ????????? ?????

#### ? ???? Format ???:
```
Date: 13-12-24 (DD-MM-YY)
Time: 11:10:38 (24-hour format, no AM/PM)
```

? ??? format: `12:13:38 11:10 AM` (?????? ????? time format)

---

## ? ??? ?: ??????? Server Configuration

### Option A: Menu ???? Configuration (Recommended)

1. **Menu** ? **Comm** ? **Cloud Server** (???? **Push Protocol**)
2. ????? ???? ???:
   ```
   Server Address: pushapi.sikkhaloy.com
   Port: 443
   Path: /iclock/cdata
   Enable Push: Yes
   Push Interval: 30 (seconds)
   Protocol: ADMS (if available)
   ```
3. **Save** ???? ??? **Test Connection** ????
4. Success ??? **Restart Device** ????

### Option B: Web Interface ???? Configuration

1. ????????? ???????? IP address ??? (????: `http://192.168.1.100`)
2. **Login** ???? (default: admin/admin)
3. **Communication** ? **Server Settings** (???? **Push Protocol**)
4. ????? ???? ???:
   ```
   Server Address: pushapi.sikkhaloy.com
   Server Port: 443
   Push Protocol: Enable
   Transaction Interval: 30
   HTTPS: Enable (if available)
   ```
5. **Apply** ???? ??? **Save Configuration**

---

## ? ??? ?: Database ? Device Register ???

### SQL Query ????? Register:
```sql
-- Check if device exists
SELECT * FROM Device_Institution_Mapping 
WHERE DeviceSerialNumber = 'YOUR_DEVICE_SN'

-- If not exists, insert:
INSERT INTO Device_Institution_Mapping 
(SchoolID, DeviceSerialNumber, DeviceName, DeviceLocation, IsActive, CreatedDate)
VALUES 
(1012, 'YOUR_DEVICE_SN', 'Main Gate Device', 'Main Gate', 1, GETDATE())
```

### API ????? Register:
```bash
POST https://pushapi.sikkhaloy.com/api/dashboard/add-device
Content-Type: application/json

{
  "schoolID": 1012,
  "deviceSerialNumber": "YOUR_DEVICE_SN",
  "deviceName": "Main Gate Device",
  "deviceLocation": "Main Gate",
  "isActive": true,
  "remarks": "First device"
}
```

---

## ? ??? ?: Test ????

### 3.1 Device DateTime Configuration Check:
```
https://pushapi.sikkhaloy.com/iclock/configure-datetime?SN=YOUR_DEVICE_SN
```

### 3.2 Device Status Check:
```
https://pushapi.sikkhaloy.com/api/devices/test?sn=YOUR_DEVICE_SN
```

### 3.3 Dashboard ???? ?? Device ?????:
```
https://pushapi.sikkhaloy.com/api/dashboard/devices
```

### 3.4 Today's Attendance Check:
```
https://pushapi.sikkhaloy.com/api/devices/attendance/today?schoolID=1012
```

### 3.5 Device Ping Test:
```
https://pushapi.sikkhaloy.com/iclock/ping?SN=YOUR_DEVICE_SN
```

---

## ? ??? ?: Troubleshooting

### ?????? ?: Date/Time Format ??? ???????? (????: "12:13:38 11:10 AM")

**????:** Device ?? Date/Time format settings ??? ???

**??????:**
1. ????? "Device Date/Time Format ??? ????" section follow ????
2. Device restart ????
3. ???? punch ??? test ????

### ?????? ?: lastPushTime = null

**????:** ?????? ???????? connect ??? ????? ??

**??????:**
1. ??????? ???? Server URL ??? ???? ??? ????
2. ?????? Internet ? connected ??? ???? ??? ????
3. Firewall/Router ? Port 443 open ??? ???? ??? ????
4. ?????? restart ????
5. Network connectivity test ????:
   ```bash
   ping pushapi.sikkhaloy.com
   telnet pushapi.sikkhaloy.com 443
   ```

### ?????? ?: Connection failed

**????:** Network ?????? ?? Port block

**??????:**
```bash
# PC ???? test ????:
ping pushapi.sikkhaloy.com

# Port test (Windows):
telnet pushapi.sikkhaloy.com 443

# Port test (PowerShell):
Test-NetConnection pushapi.sikkhaloy.com -Port 443
```

### ?????? ?: Data push ????? ??

**????:** Device settings ??? ???? Push Protocol disable

**??????:**
1. Device ? "Push Protocol" enable ??? ???? ??? ????
2. Transaction Interval ???? ??? ???? (30 seconds recommended)
3. Device time ???? ??? ???? ??? ????
4. Device ? server connection status ????? (should show "Connected")

### ?????? ?: Attendance data wrong date/time ? save ?????

**????:** Device ?? Date/Time format ??? configured

**??????:**
1. Device LCD ?? current date/time ?????
2. ??? format ??? ??? (????: "12:13:38 11:10 AM"), ?????:
   - Method 1 ?? Method 2 (NTP Server) use ????
   - Device restart ????
3. API code ???????? multiple date formats support ???:
   - DD-MM-YY HH:mm:ss (Device default)
   - DD-MM-YYYY HH:mm:ss
   - DD/MM/YY HH:mm:ss
   - yyyy-MM-dd HH:mm:ss (ISO format)

---

## ? ??? ?: Device Settings Verify ????

??????? **Menu ? System Info** ? ????? ??? ????:
- Serial Number: ?
- Firmware Version: ?
- Date Format: DD-MM-YY
- Time Format: 24H
- Time Zone: GMT+6
- Network Status: Connected ?
- Server Status: Connected ?
- Last Upload Time: (???? ??????) ?

---

## ?? Important Notes:

1. ?????? ??? ??????? ??? network ? ????? ??? ??
2. ???????? Internet connection ?????? ??????
3. Server URL ? `http://` ?? `https://` ??????? ????? ???
4. Port 443 (HTTPS) ??????? ????
5. ?????? ????? 30 ???????? data push ????
6. **Date/Time format ?????? DD-MM-YY ??? 24H format ??? ???**
7. NTP Server ??????? ???? time automatically sync ???

---

## ?? API Endpoints:

### Device Configuration:
- `GET /iclock/configure-datetime?SN={serial}` - Date/Time configuration check
- `GET /api/devices/test?sn={serial}` - Device test ????
- `GET /api/dashboard/devices` - ?? device ?????
- `POST /api/dashboard/add-device` - ???? device add ????
- `GET /iclock/ping?sn={serial}` - Device ping ????

### Device Communication:
- `GET /iclock/cdata?SN={serial}` - Device handshake
- `GET /iclock/getrequest?SN={serial}` - ADMS getrequest
- `POST /iclock/cdata?SN={serial}&table=ATTLOG` - Attendance data receive

### Attendance:
- `GET /api/devices/attendance/today?schoolID={id}` - ????? attendance
- `GET /api/devices/attendance/yesterday?schoolID={id}` - ??????? attendance

### Logs:
- `GET /api/logs/view?date={yyyy-MM-dd}` - Device logs ?????
- `GET /api/logs/latest?hours=24` - ??? 24 ?????? logs

---

## ? Success Indicators:

??? ?? ??? ??? ??? ??????:
- ? Device display ?? ???? Date/Time format (DD-MM-YY HH:MM:SS)
- ? Device display ?? "Server Connected" ??????
- ? `lastPushTime` ? ???? ??????
- ? `connectionStatus: "OK"`
- ? Attendance data database ? ???????? save ???
- ? Device logs ? "HANDSHAKE", "DATA_RECEIVED" ??????

---

## ?? Support & Troubleshooting URLs:

??? ???? ?????? ???, ?? URL ???? ??? ????:

1. **DateTime Configuration Check:**
   ```
   https://pushapi.sikkhaloy.com/iclock/configure-datetime?SN=YOUR_SN
   ```

2. **Device Status:**
   ```
   https://pushapi.sikkhaloy.com/api/devices/test?sn=YOUR_SN
   ```

3. **Today's Device Logs:**
   ```
   https://pushapi.sikkhaloy.com/api/logs/view?date=2024-12-13
   ```

4. **API Version & Health:**
   ```
   https://pushapi.sikkhaloy.com/api/devices/version
   ```

5. **Server Stats:**
   ```
   https://pushapi.sikkhaloy.com/api/dashboard/stats
   ```

---

## ?? Quick Reference Card

### iClock9000-G Specific Settings:
```
Device Model: iClock9000-G
Supported Protocol: ADMS, Push Protocol
Communication: TCP/IP, Wi-Fi
Date Format: DD-MM-YY (Device default)
Time Format: 24H
Recommended NTP: time.google.com
Server Port: 443 (HTTPS)
Push Interval: 30 seconds
```

### Common Date/Time Formats:
- ? Correct: `13-12-24 11:10:38` (DD-MM-YY 24H)
- ? Wrong: `12:13:38 11:10 AM` (Mixed format)
- ? Wrong: `12/13/24 11:10 PM` (US format)

---

**????????! ??**

**??? ??????:** Device ?? Date/Time format ???? configuration ??????? ????????????!
